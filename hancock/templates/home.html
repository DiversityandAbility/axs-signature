{% extends "base.html" %}

{% block extra_head %}
    <script src="{{ url_for('static', filename='signature.js') }}"></script>
{% endblock %}

{% block body %}
    <h1 class="text-3xl mb-4">Welcome to AXS Signature</h1>
    <p class="text-lg mb-4">AXS Signature is a free and open source service that makes it easy for you to request electronic signatures from your users.</p>
    <p class="text-lg mb-4">It's designed to be: easy to use, for you and your users; accessible, so everyone can use it; and secure, so you know you can trust and verify the signatures.</p>

    <h2 class="text-2xl mb-4">Try it!</h2>
    <div class="try-it">
        <p class="text-lg mb-4">Pop your email address in the box below, click the button, and you're off! If you want to learn more, <a href="/docs/">read our documentation</a>.</p>
        <form id="request-form">
            <div class="flex flex-row items-end gap-2">
                <div class="grow">
                    <label for="signee_email" class="">Your Email</label>
                    <input type="email" id="signee_email" name="signee_email" class="focus:border-dahyperblue appearance-none rounded border-2 py-2 px-3 focus:outline-none w-full" required placeholder="e.g. john.smith@example.com">
                </div>
                <div class="">
                    <button class="rounded text-white uppercase pl-4 pr-4 py-2 cursor-pointer border-b-4 border-black bg-dahyperblue hover:bg-dadarkblue text-xl">
                        <i class="mr-1 fal fa-fw fa-signature"></i>
                        Sign Here
                    </button>
                </div>
            </div>
        </form>
    </div>
    <div class="signature hidden">
        <p class="text-lg mb-4">Here's your signature, ready to be embedded in a document!</p>
        <div class="text-center">
            <object type="image/svg+xml" data="" class="inline"></object>
        </div>
    </div>
{% endblock %}

{% block extra_body %}
    <script>
        (() => {
            let form = document.getElementById("request-form");
            form.addEventListener("submit", async evt => {
                evt.preventDefault();
                let imageUrl = await window.AXSSignature(
                    window.location.origin,
                    "123",
                    {
                        redirect_uri: "{{ request.url }}",
                        title: "Demo Signature",
                        declaration: "I'm testing out AXS Signature and I'm loving how easy it is to use!",
                        signee_email: document.getElementById("signee_email").value,
                    }
                );
                document.querySelector(".signature object").setAttribute("data", imageUrl);
                document.querySelector(".signature").classList.toggle("hidden");
                document.querySelector(".try-it").classList.toggle("hidden");
                return false;
            });
        })();
    </script>
{% endblock %}